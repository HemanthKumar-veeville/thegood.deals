import{a as y,r as f,R as j,f as N,u as k,j as e,B as D,d as I}from"./index-BEpdRwZu.js";import{S as O}from"./sweetalert2.all-B4gRXNNk.js";import"./UserAlt-D6GIxmga.js";import"./SideBar-3NVdxZP5.js";import T from"./CustomLoader-B-SBCHVN.js";import"./france-flag-icon-BP-lwE0P.js";const _=({value:i,onChange:o,index:s,inputRefs:c})=>e.jsx("div",{className:"flex flex-col w-12 h-12 items-start gap-[5px] relative",children:e.jsx("div",{className:"flex flex-col items-center gap-2.5 relative flex-1 self-stretch w-full grow",children:e.jsx("input",{type:"text",maxLength:"1",value:i,onChange:l=>o(l.target.value,s),ref:c[s],onKeyDown:l=>{l.key==="Backspace"&&!i&&s>0&&c[s-1].current.focus()},onPaste:l=>{const u=l.clipboardData.getData("Text"),x=[...otp];u.slice(0,5).split("").forEach((d,n)=>{s+n<otp.length&&(x[s+n]=d,c[s+n].current.value=d)}),setOtp(x),c[Math.min(s+u.length,otp.length-1)].current.focus(),l.preventDefault()},inputmode:"numeric",pattern:"[0-9]*",className:"flex items-start justify-center gap-2.5 pl-5 pr-4 py-3 relative flex-1 self-stretch w-full grow bg-white rounded-md border border-solid border-stroke text-[#9CA3AF] text-base tracking-[0] leading-6 text-center focus: outline-[#1b4f4a]"})})}),P=()=>{const{t:i}=y(),[o,s]=f.useState(Array(5).fill("")),[c,l]=f.useState(33),[u,x]=f.useState(!0),[d,n]=f.useState(!1),g=f.useRef(o.map(()=>j.createRef())),h=N(),w=k(),{state:p}=h;f.useEffect(()=>{const t=setInterval(()=>{l(a=>a>0?a-1:0)},1e3);return()=>clearInterval(t)},[]),f.useEffect(()=>{window.scrollTo(0,0)},[]);const v=(t,a)=>{if(/^[0-9]$/.test(t)||t===""){const m=[...o];m[a]=t,s(m),t!==""&&a<o.length-1&&g.current[a+1].current.focus(),m.every(r=>r!=="")?x(!1):x(!0)}},b=async()=>{var a,m;n(!0),console.log("OTP submitted:",o.join(""));const t=new FormData;t.append("email",p==null?void 0:p.email),t.append("verification_code",o.join(""));try{const r=await I.post("verify",t);(r==null?void 0:r.status)===201?w("/"):n(!1)}catch(r){console.error("There was an error!",r),O.fire({icon:"error",title:"Oops...",text:(m=(a=r==null?void 0:r.response)==null?void 0:a.data)==null?void 0:m.detail}),n(!1)}s(Array(5).fill("")),n(!1)};return e.jsxs("div",{className:"relative w-full h-[640px] bg-primary-background mx-auto",children:[!d&&e.jsxs("div",{className:"flex flex-col w-full items-start gap-[15px] px-[35px] py-[15px] absolute left-0",children:[e.jsxs("div",{className:"relative w-fit mt-[-1.00px] [font-family:'Inter',Helvetica] font-semibold !text-[#1b4f4a] text-2xl text-center tracking-[0] leading-[30px] whitespace-nowrap",children:[i("otp.confirm_email")," "]}),e.jsxs("p",{className:"relative w-fit [font-family:'Inter',Helvetica] font-normal !text-[#1b4f4a] text-sm tracking-[0] leading-[22px]",children:[i("otp.code_sent")," ",e.jsx("br",{}),(p==null?void 0:p.email)||"{email}"]}),e.jsx("div",{className:"flex items-center justify-between relative self-stretch w-full flex-[0_0_auto]",children:o.map((t,a)=>e.jsx(_,{value:t,onChange:v,index:a,inputRefs:g.current},a))}),c!==0&&e.jsxs("div",{className:"relative w-fit [font-family:'Inter',Helvetica] font-normal text-secondary-text-color text-sm tracking-[0] leading-[22px] whitespace-nowrap",children:[i("otp.send_again")," (",c,"s) "]}),e.jsx("div",{onClick:u?null:b,className:"!w-full",children:e.jsx(D,{buttonText:i("otp.login"),className:"!self-stretch !flex-[0_0_auto] !flex !w-full hover:bg-secondary-background cursor-pointer",color:"primary",kind:"primary",round:"semi-round",state:u?"disable":"active"})})]}),d&&e.jsx(T,{})]})};export{P as VerificationOTP,P as default};
